### 展讯平台启动流程

展讯智能机的FDL1，SPL文件由代码中的chipram文件夹生成，FDL2，UBOOT文件则由u-boot文件夹生成。

系统上电开机，IROM中的Romcode开始运行，检查系统download键是否按下，若是，则进入下载流程，否则进入开机流程：

一.   下载过程

1.      Romcode（0x00000000）：与PC通信，下载FDL1到IRAM。FDL1只包含DDR驱动及配置，只需要几KB的运行空间，可以被ROMCODE与下载工具通讯将之下载到IRAM中运行。

2.      FDL1：FDL1被下载到IRAM后，PC指针跳到IRAM的起始地址开始运行FDL1。FDL1首先初始化外部DDRRAM，配置外部DDR的寄存器和时序，然后再与下载工具通讯将FDL2下载到外部DDR中运行。

3.      FDL2：FDL2被下载到DDR中之后，有充足的运行空间，FDL2带NAND/EMMCflash驱动程序，可以初始化FLASH，并把PAC包的其他各个模块都写入到FLASH中。



二. 开机过程

1.  Romcode：0x00000000：判断是开机，复制spl到IRAM，并运行spl （包含DDR驱动及配置）

2. SPL：初始化外部DDRRAM，配置外部DDR的寄存器和时序，然后再与下载工具通讯,将uboot下载到外部DDR中运行

3. UBOOT：带NAND/EMMCflash驱动程序，带部分设备初始化，复制其他image到DDRRAM ，判断开机模式并进入相应模式。



三.Uboot启动过程

​	StageI：第一阶段的功能（展讯为16k的汇编代码）
​		硬件设备初始化
​		加载U-Boot第二阶段代码到RAM空间
​		设置好栈
​		跳转到第二阶段代码入口

​	StageII：第二阶段的功能
​		初始化本阶段使用的硬件设备
​		检测系统内存映射
​		将内核从Flash读取到RAM中
​		为内核设置启动参数
​		调用内核